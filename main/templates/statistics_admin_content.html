<!-- 찐최종 -->
{% load static %}
<script src="{% static 'main/js/statistics_graph.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<h1>응답합 출력</h1>
<ul>
    {% for response in responses %}
        <li>문항 {{ forloop.counter }}: {{ response }}</li>
    {% endfor %}
</ul>

<h1>평균 출력</h1>
<ul>
    <li>총 평균 점수: {{ average_response }}</li>
</ul>

<h1>section별 평균 출력</h1>
<ul>
    <li>총 평균 점수: {{ average_section_response }}</li>
</ul>

<h1>전체 평균 출력</h1>
<ul>
    <li>총 평균 점수: {{ average_total_response }}</li>
</ul>

<!-- 그래프 그리기 -->
<canvas id="student_question_canvas" width="400" height="200"></canvas>
<canvas id="student_section_canvas" width="400" height="200"></canvas>
<canvas id="student_total_canvas" width="400" height="200"></canvas>



<script>
    /*document.addEventListener("DOMContentLoaded", function() {
        console.log("DOM이 로드되었습니다.");  // DOM이 로드되었는지 확인 - 디버깅

        var ctx = document.getElementById('student_question_canvas');
        if (!ctx) {
            console.error("Canvas를 찾을 수 없습니다.");
            return;
        } else {
            console.log("Canvas 찾음: student_question_canvas");
        }

        //디버깅끝


        // 첫 번째 그래프 (문항별 평균 점수)
        var labels = Array.from({length: {{ average_response|length }}}, (v, k) => "문항 "+ (k+1));
        var data = JSON.parse('{{ average_response|escapejs }}');

        console.log("데이터 로딩됨:", data); //디버깅
        console.log("평균 응답 데이터:", {{ average_response|escapejs }});

        var ctx = document.getElementById('student_question_canvas').getContext('2d');
        var student_canvas = new Chart(ctx, {
            type: 'bar', //막대그래프 (그래프 타입)
            data: {
                labels : labels,
                datasets: [{
                    label: '문항별 평균 점수',
                    data: data, 
                    backgroundColor: 'rgba(75, 192, 192, 0.2)', //막대 색
                    borderColor: 'rgba(75, 192, 192, 1)', //막대 테두리 색
                    borderWidth: 1
                }]
            }, 
            options: {
                scales: {
                    y: {
                        beginAtZero: true, 
                        max: 5
                    }
                }
            }
        });

        // 두 번째 그래프 (영역별 평균 점수)
        var sectionLabels = ["학교문화", "학교구조", "민주시민교육"];
        var sectionData = JSON.parse('{{ average_section_response|escapejs }}');

        var ctx2 = document.getElementById('student_section_canvas').getContext('2d');
        var student_section_canvas = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: sectionLabels,
                datasets: [{
                    label: '영역별 평균 점수',
                    data: sectionData,
                    backgroundColor: 'rgba(153, 102, 255, 0.2)', 
                    borderColor: 'rgba(153, 102, 255, 1)', 
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 5
                    }
                }
            }
        });

        // 세 번째 그래프 (총 평균 점수)
        var totalLabels = ["총 평균 점수"];
        var totalData = JSON.parse('{{ average_total_response|escapejs }}');

        var ctx3 = document.getElementById('student_total_canvas').getContext('2d');
        var student_total_canvas = new Chart(ctx3, {
            type: 'bar',
            data: {
                labels: totalLabels,
                datasets: [{
                    label: '총 평균 점수',
                    data: totalData,
                    backgroundColor: 'rgba(255, 99, 132, 0.2)', 
                    borderColor: 'rgba(255, 99, 132, 1)', 
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 5
                    }
                }
            }
        });
    });
   
    */
</script>

</body>
</html>